<!DOCTYPE html>
<html lang="ar" dir="rtl">

<head>
  <!-- Basic Meta Tags -->
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <!-- SEO Meta -->
  <title>Science مع مستر عمر طارق ✨ | ساينس ممتع مش صعب</title>
  <meta name="description"
    content="تعلم مادة Science مع مستر عمر طارق طه الصادق لطلاب الإعدادي وأولى ثانوي. شرح مبسط، فهم حقيقي، وساينس ممتع بعيد عن الحفظ والتعقيد." />
  <meta name="keywords"
    content="مستر عمر طارق, ساينس, شرح ساينس, Science إعدادي, Science أولى ثانوي, فهم مش حفظ, تبسيط العلوم, مدرس Science القاهرة" />
  <meta name="author" content="Mr. Omar Tarek" />

  <!-- Open Graph (Social Media Preview) -->
  <meta property="og:title" content="Science مع مستر عمر طارق ✨" />
  <meta property="og:description" content="مع بعض الساينس هيبقى ممتع مش صعب ✨  
    افتكر دايمًا إن الساينس فهم مش حفظ." />
  <meta property="og:image" content="/media/img/main-img.webp" />
  <meta property="og:type" content="website" />
  <meta property="og:locale" content="ar_AR" />

  <!-- Structured Data: Website -->
  <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "WebSite",
      "name": "Science مع مستر عمر",
      "url": "https://mr-omartarek.com",
      "potentialAction": {
        "@type": "SearchAction",
        "target": "https://mr-omartarek.com/search?q={search_term_string}",
        "query-input": "required name=search_term_string"
      }
    }
  </script>

  <!-- Structured Data: Teacher -->
  <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "Person",
      "name": "مستر عمر طارق طه الصادق",
      "jobTitle": "مدرس Science",
      "description": "مدرس مادة Science لطلاب الإعدادي وأولى ثانوي، متخصص في الشرح المبسط والفهم العميق بعيدًا عن الحفظ.",
      "url": "https://mr-omartarek.com",
      "sameAs": [
        "https://www.facebook.com/share/16ajr7fnMq/",
        "https://youtube.com/@science-mr-omar",
        "https://www.instagram.com/omartarek_213"
      ]
    }
  </script>

  <!-- Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700&family=Lemonada:wght@400;600&display=swap"
    rel="stylesheet" />

  <!-- Favicons -->
  <link rel="apple-touch-icon" sizes="180x180" href="/favicon/apple-touch-icon.png" />
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon/favicon-32x32.png" />
  <link rel="icon" type="image/png" sizes="16x16" href="/favicon/favicon-16x16.png" />
  <link rel="icon" type="image/x-icon" href="/favicon/favicon.ico" />
  <link rel="manifest" href="/favicon/site.webmanifest" />

  <!-- Styles -->
  <!-- Styles -->
  <link rel="stylesheet" href="/css/bootstrap.min.css" />
  <link rel="stylesheet" href="/css/animate.min.css" />
  <link rel="stylesheet" href="/css/wow.min.css" />
  <link rel="stylesheet" href="/css/all.min.css" />
  <link rel="stylesheet" href="/css/global.css?v=1.0.0" />
  <link rel="stylesheet" href="/css/style.css?v=1.0.0" />

  <!-- SweetAlert2 -->
  <link
    rel="stylesheet"
    href="https://cdnjs.cloudflare.com/ajax/libs/limonte-sweetalert2/11.10.1/sweetalert2.min.css"
  />
  <script src="https://cdnjs.cloudflare.com/ajax/libs/limonte-sweetalert2/11.10.1/sweetalert2.all.min.js"></script>
</head>



  <body>

        <!-- Start navbar section -->
    <nav class="nav-home position-relative">
      <div class="container">
        <div class="row">
          <div class="col-md-12 nav-content">
            <div class="content">
              <div id="nav-links-container">
                <div class="parent-spinner">
                  <div class="spinner">
                    <div></div>
                    <div></div>
                    <div></div>
                    <div></div>
                    <div></div>
                    <div></div>
                  </div>
                </div>

                <div id="menu-toggle">
                  <i class="fa-solid fa-bars bars"></i>
                </div>

                <!-- روابط التنقل -->
                <ul class="links">
                  <li>
                    <a href="/create-account.html
                    " class="create-account">
                      <lord-icon
                        src="https://cdn.lordicon.com/exymduqj.json"
                        trigger="loop"
                        stroke="bold"
                        state="loop-cycle"
                        colors="primary:#F3F3F3,secondary:#FF9D00"
                        style="width: 35px; height: 35px"
                        id="icon-create-button"
                      >
                      </lord-icon>
                      انشئ حسابك
                    </a>
                  </li>
                  <li>
                    <a href="/login.html" class="login-button">
                      <lord-icon
                        src="https://cdn.lordicon.com/olfvnikl.json"
                        trigger="loop"
                        stroke="bold"
                        state="hover-searching"
                        colors="primary:#B6771D,secondary:#7B542F"
                        id="icon-login-button"
                      >
                      </lord-icon>
                      سجل دخولك
                    </a>
                  </li>
                </ul>
              </div>

              <div class="content-2">
                <!-- زر الوضع الليلي -->

                <div dir="ltr" class="dark-mode">
                  <div id="shape" class="changer"></div>
                  <div id="toggle" class="changer">
                    <span class="changer">
                      <i
                        class="moon changer d-flex justify-content-center align-items-center"
                      >
                        <ion-icon name="cloudy-night-outline"></ion-icon>
                      </i>
                      <i
                        class="sun changer d-flex justify-content-center align-items-center"
                      >
                        <ion-icon name="partly-sunny-outline"></ion-icon>
                      </i>
                    </span>
                  </div>
                </div>

                <!-- لوجو -->
                <a href="/" class="logo">
                  <img src="media/img/logo.webp" alt="logo" />
                </a>
              </div>
            </div>
            <div class="scroll-line"></div>
          </div>
        </div>
      </div>
    </nav>
    <!-- End navbar section -->



    <!-- Start courses  section -->
<br>
<br>
    <br>
<br>
<br>

    <section class="courses-home courses">
  <div class="container">
    <div class="row">
          <div class="col-md-12 mb-5">
            <div class="speacial-heading">
              <h1>كورساتك</h1>
            </div>
          </div>

      <!-- Dynamic Courses Container -->
      <div class="col-md-12">
        <div class="row" id="courses-container"></div>

      </div>
    </div>
  </div>
</section>

<script>

const API_URL = 'https://api-platfrom.ro-s.net/api/get-courses';
const STORAGE_BASE_URL = 'http://127.0.0.1:8000/storage/';

function formatArabicDate(dateString) {
  const date = new Date(dateString);
  const arabicMonths = [
    'يناير', 'فبراير', 'مارس', 'أبريل', 'مايو', 'يونيو',
    'يوليو', 'أغسطس', 'سبتمبر', 'أكتوبر', 'نوفمبر', 'ديسمبر'
  ];
  const arabicDays = [
    'الأحد', 'الاثنين', 'الثلاثاء', 'الأربعاء', 'الخميس', 'الجمعة', 'السبت'
  ];
  const day = arabicDays[date.getDay()];
  const dayNumber = date.getDate();
  const month = arabicMonths[date.getMonth()];
  const year = date.getFullYear();
  return `${day}، ${dayNumber} ${month} ${year}`;
}

function createCourseCard(course) {
  const startDate = course.start_date ? formatArabicDate(course.start_date) : formatArabicDate(course.created_at);
  const endDate = course.end_date ? formatArabicDate(course.end_date) : formatArabicDate(course.updated_at);
  let imageUrl = 'media/img/4.webp';
  if (course.image) {
    if (course.image.startsWith('http')) {
      imageUrl = course.image;
    } else {
      imageUrl = `${STORAGE_BASE_URL}${course.image}`;
    }
  }
  return `
    <div class="col-md-6 col-lg-4 card-course">
      <div class="course">
        <img src="${imageUrl}" alt="${course.name}" loading="lazy" />
        <div class="content-course">
          <h4>
            ${course.title || course.name} - ${course.grade ? course.grade.name : ''}
          </h4>
          <p class="number-lect">
            ${course.description}
          </p>
          <div class="data-course">
            <div class="you-subscription">انت مشترك</div>
            <div class="info-course">
              <p class="date-course">
                ${startDate}
                <i class="fa-solid fa-folder-plus"></i>
              </p>
              <p class="update-course">
                ${endDate}
                <i class="fa-solid fa-file-circle-plus fa-fade"></i>
              </p>
            </div>
          </div>
          <div class="course-subscription">
            <a href="course-page.html?id=${course.id}" class="check">افتح الكورس</a>
          </div>
        </div>
      </div>
    </div>
  `;
}

function fetchCoursesWithTenant() {
  // Get API token from localStorage
  const apiToken = localStorage.getItem('apiToken');
  const headers = {
    'Content-Type': 'application/json',
    'Accept': 'application/json'
  };
  if (apiToken) {
    headers['Authorization'] = `Bearer ${apiToken}`;
  }
  if (typeof tenantFetch !== 'function') {
    setTimeout(fetchCoursesWithTenant, 50);
    return;
  }
  tenantFetch(API_URL, {
    method: 'GET',
    headers: headers
  })
  .then(response => response.json())
  .then(data => {
    let coursesList = [];
    if (data.success) {
      if (Array.isArray(data.courses)) {
        coursesList = data.courses;
      } else if (data.courses && Array.isArray(data.courses.data)) {
        coursesList = data.courses.data;
      }
    }
    const coursesContainer = document.getElementById('courses-container');
    if (data.success) {
      if (coursesList.length > 0) {
        const coursesHTML = coursesList.map(course => createCourseCard(course)).join('');
        coursesContainer.innerHTML = coursesHTML;
      } else {
        coursesContainer.innerHTML = `
        <div class="col-12 text-center mt-5">
          <div class="alert" style="padding: 2rem; border-radius: 15px; background-color: #faf7e6; border: 2px solid #7B542F; color: #7B542F;">
            <h4 class="alert-heading" style="font-family: 'DG-3asomy-Regular';">أهلاً بك!</h4>
            <p style="font-size: 18px; color: #7B542F;">يبدو أنك لم تشترك في أي كورس بعد. استكشف كورساتنا وابدأ رحلتك في التفوق!</p>
            <hr>
            <a href="index.html" class="btn" style="font-family: 'Expo Arabic Book'; background-color: #7B542F; color: white;">تصفح الكورسات</a>
          </div>
        </div>
        `;
      }
    } else {
      console.error('فشل في تحميل الكورسات:', data.message || 'خطأ غير معروف');
      showErrorMessage('فشل في تحميل الكورسات: ' + (data.message || 'توكن غير صالح أو انتهت الجلسة'));
    }
  })
  .catch(error => {
    console.error('خطأ في تحميل البيانات:', error);
    showErrorMessage('عذراً، حدث خطأ في تحميل الكورسات. يرجى التأكد من الاتصال بالإنترنت والمحاولة مرة أخرى.');
  });
}

// Function to show error message
function showErrorMessage(message) {
  document.getElementById('courses-container').innerHTML = `
    <div class="col-12 text-center">
      <div class="alert alert-warning" role="alert">
        <i class="fa-solid fa-exclamation-triangle"></i>
        <p class="mb-0">${message}</p>
        <button class="btn btn-primary mt-2" onclick="loadCourses()">
          <i class="fa-solid fa-refresh"></i> إعادة المحاولة
        </button>
      </div>
    </div>
  `;
}

// Load courses when page loads
document.addEventListener('DOMContentLoaded', function() {
  // Check if user is logged in
  const apiToken = localStorage.getItem('apiToken');
  const studentData = localStorage.getItem('studentData');
  if (!apiToken || !studentData) {
    window.location.href = 'login.html';
    return;
  }
  fetchCoursesWithTenant();
});
</script>
    <!-- End courses  section -->

    <!-- Start footer section home -->

    <div id="footer"></div>
    <script src="js/footer.js"></script>

    <!-- End footer section home -->

    <script
      type="module"
      src="https://unpkg.com/ionicons@7.1.0/dist/ionicons/ionicons.esm.js"
    ></script>
    <script
      nomodule
      src="https://unpkg.com/ionicons@7.1.0/dist/ionicons/ionicons.js"
    ></script>

    <!-- file main js -->
    <script src="js/main.js" defer></script>
    <!-- file js fonts -->
    <script src="js/all.min.js" defer></script>
    <!-- jquery -->
    <script src="js/jquery.slim.min.js" defer></script>
    <!-- file js bootstrap -->
    <script src="js/bootstrap.min.js" defer></script>
    <!-- popper -->
    <script src="js/popper.min.js" defer></script>
       <!-- lord icon -->
    <script src="https://cdn.lordicon.com/lordicon.js" defer></script>
    <!-- file wow -->
    <!-- <script src="js/wow.min.js"></script> -->
    <!-- script to start wow -->
    <!-- <script>
      new WOW().init();
    </script> -->

  </body>
</html>
  </body>
</html>
