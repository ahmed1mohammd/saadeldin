# ✅ تفعيل إعادة الكتابة
RewriteEngine On

# إزالة .html من الروابط
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{REQUEST_FILENAME}\.html -f
RewriteRule ^([^/]+)$ $1.html [L]

# إعادة توجيه الروابط التي تحتوي .html إلى بدونها (SEO-friendly)
RewriteCond %{THE_REQUEST} ^[A-Z]{3,}\s([^.]+)\.html [NC]
RewriteRule ^ %1 [R=301,L]

# إعادة توجيه index.html إلى /
RewriteCond %{THE_REQUEST} ^[A-Z]{3,}\s/+index\.html [NC]
RewriteRule ^ / [R=301,L]

# منع الوصول المباشر لملف .htaccess
<Files .htaccess>
    Order allow,deny
    Deny from all
</Files>

# ✅ تفعيل CORS للـ API
<IfModule mod_headers.c>
    Header always set Access-Control-Allow-Origin "*"
    Header always set Access-Control-Allow-Methods "GET, POST, PUT, DELETE, OPTIONS"
    Header always set Access-Control-Allow-Headers "Content-Type, Authorization, X-Requested-With"
</IfModule>

# ✅ منع التخزين المؤقت للمحتوى الديناميكي
<IfModule mod_headers.c>
    Header set Cache-Control "no-store, no-cache, must-revalidate, max-age=0"
    Header set Pragma "no-cache"
    Header set Expires "Thu, 01 Jan 1970 00:00:00 GMT"
</IfModule>

# ✅ تفعيل ضغط Gzip لتحسين سرعة التحميل
<IfModule mod_deflate.c>
    AddOutputFilterByType DEFLATE text/text text/html text/plain text/xml text/css
    AddOutputFilterByType DEFLATE application/javascript application/json application/xml application/xhtml+xml
</IfModule>

# ✅ تفعيل التخزين المؤقت (Caching) للملفات الثابتة
<IfModule mod_expires.c>
    ExpiresActive On
    ExpiresDefault "access plus 1 month"

    ExpiresByType image/jpg "access plus 1 year"
    ExpiresByType image/jpeg "access plus 1 year"
    ExpiresByType image/gif "access plus 1 year"
    ExpiresByType image/png "access plus 1 year"
    ExpiresByType image/webp "access plus 1 year"
    ExpiresByType text/css "access plus 1 month"
    ExpiresByType text/javascript "access plus 1 month"
    ExpiresByType application/javascript "access plus 1 month"
    ExpiresByType application/font-woff2 "access plus 1 year"
</IfModule>

# ✅ تفعيل ضغط Brotli (لو السيرفر يدعمه)
<IfModule mod_brotli.c>
    BrotliCompressionQuality 5
    AddOutputFilterByType BROTLI_COMPRESS text/html text/plain text/css application/javascript application/json
</IfModule>

# ✅ تمكين Keep-Alive لتحسين تحميل الصور والملفات
<IfModule mod_headers.c>
    Header set Connection keep-alive
</IfModule>
